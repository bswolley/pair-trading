{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///Users/dorian/Documents/pair-trading/frontend/src/app/api/trades/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport fs from \"fs\";\nimport path from \"path\";\n\nconst CONFIG_PATH = path.join(process.cwd(), \"..\", \"config\");\n\n// GET /api/trades - Get all trades (bot + user)\nexport async function GET() {\n  try {\n    // Bot trades\n    const botTradesPath = path.join(CONFIG_PATH, \"active_trades_sim.json\");\n    let botTrades = { trades: [] };\n    if (fs.existsSync(botTradesPath)) {\n      botTrades = JSON.parse(fs.readFileSync(botTradesPath, \"utf-8\"));\n    }\n\n    // User trades\n    const userTradesPath = path.join(CONFIG_PATH, \"active_trades.json\");\n    let userTrades: Record<string, unknown> = {};\n    if (fs.existsSync(userTradesPath)) {\n      userTrades = JSON.parse(fs.readFileSync(userTradesPath, \"utf-8\"));\n    }\n\n    // Convert user trades object to array format\n    const userTradesArray = Object.entries(userTrades).map(([pair, trade]) => ({\n      pair,\n      ...(trade as object),\n      isUserTrade: true,\n    }));\n\n    return NextResponse.json({\n      botTrades: botTrades.trades || [],\n      userTrades: userTradesArray,\n    });\n  } catch (error) {\n    console.error(\"Error reading trades:\", error);\n    return NextResponse.json({ error: \"Failed to read trades\" }, { status: 500 });\n  }\n}\n\n// POST /api/trades - Add new user trade\nexport async function POST(request: Request) {\n  try {\n    const trade = await request.json();\n    const userTradesPath = path.join(CONFIG_PATH, \"active_trades.json\");\n    \n    let userTrades: Record<string, unknown> = {};\n    if (fs.existsSync(userTradesPath)) {\n      userTrades = JSON.parse(fs.readFileSync(userTradesPath, \"utf-8\"));\n    }\n\n    const pairKey = `${trade.symbol1}_${trade.symbol2}`;\n    userTrades[pairKey] = {\n      symbol1: trade.symbol1,\n      symbol2: trade.symbol2,\n      entryDate: trade.entryDate,\n      entryPrice1: trade.entryPrice1,\n      entryPrice2: trade.entryPrice2,\n      weight1: trade.weight1,\n      weight2: trade.weight2,\n      direction: trade.direction,\n    };\n\n    fs.writeFileSync(userTradesPath, JSON.stringify(userTrades, null, 2));\n\n    return NextResponse.json({ success: true, pair: pairKey });\n  } catch (error) {\n    console.error(\"Error adding trade:\", error);\n    return NextResponse.json({ error: \"Failed to add trade\" }, { status: 500 });\n  }\n}\n\n\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;;;;AAEA,MAAM,cAAc,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI,MAAM;AAG5C,eAAe;IACpB,IAAI;QACF,aAAa;QACb,MAAM,gBAAgB,4GAAI,CAAC,IAAI,CAAC,aAAa;QAC7C,IAAI,YAAY;YAAE,QAAQ,EAAE;QAAC;QAC7B,IAAI,wGAAE,CAAC,UAAU,CAAC,gBAAgB;YAChC,YAAY,KAAK,KAAK,CAAC,wGAAE,CAAC,YAAY,CAAC,eAAe;QACxD;QAEA,cAAc;QACd,MAAM,iBAAiB,4GAAI,CAAC,IAAI,CAAC,aAAa;QAC9C,IAAI,aAAsC,CAAC;QAC3C,IAAI,wGAAE,CAAC,UAAU,CAAC,iBAAiB;YACjC,aAAa,KAAK,KAAK,CAAC,wGAAE,CAAC,YAAY,CAAC,gBAAgB;QAC1D;QAEA,6CAA6C;QAC7C,MAAM,kBAAkB,OAAO,OAAO,CAAC,YAAY,GAAG,CAAC,CAAC,CAAC,MAAM,MAAM,GAAK,CAAC;gBACzE;gBACA,GAAI,KAAK;gBACT,aAAa;YACf,CAAC;QAED,OAAO,4LAAY,CAAC,IAAI,CAAC;YACvB,WAAW,UAAU,MAAM,IAAI,EAAE;YACjC,YAAY;QACd;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,yBAAyB;QACvC,OAAO,4LAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAwB,GAAG;YAAE,QAAQ;QAAI;IAC7E;AACF;AAGO,eAAe,KAAK,OAAgB;IACzC,IAAI;QACF,MAAM,QAAQ,MAAM,QAAQ,IAAI;QAChC,MAAM,iBAAiB,4GAAI,CAAC,IAAI,CAAC,aAAa;QAE9C,IAAI,aAAsC,CAAC;QAC3C,IAAI,wGAAE,CAAC,UAAU,CAAC,iBAAiB;YACjC,aAAa,KAAK,KAAK,CAAC,wGAAE,CAAC,YAAY,CAAC,gBAAgB;QAC1D;QAEA,MAAM,UAAU,GAAG,MAAM,OAAO,CAAC,CAAC,EAAE,MAAM,OAAO,EAAE;QACnD,UAAU,CAAC,QAAQ,GAAG;YACpB,SAAS,MAAM,OAAO;YACtB,SAAS,MAAM,OAAO;YACtB,WAAW,MAAM,SAAS;YAC1B,aAAa,MAAM,WAAW;YAC9B,aAAa,MAAM,WAAW;YAC9B,SAAS,MAAM,OAAO;YACtB,SAAS,MAAM,OAAO;YACtB,WAAW,MAAM,SAAS;QAC5B;QAEA,wGAAE,CAAC,aAAa,CAAC,gBAAgB,KAAK,SAAS,CAAC,YAAY,MAAM;QAElE,OAAO,4LAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAM,MAAM;QAAQ;IAC1D,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,uBAAuB;QACrC,OAAO,4LAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAsB,GAAG;YAAE,QAAQ;QAAI;IAC3E;AACF"}}]
}